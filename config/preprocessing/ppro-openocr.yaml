name: ppro-openocr-sharp

steps:
  # 1. Normaliza√ß√£o suave de ilumina√ß√£o
  normalize_colors:
    enabled: true
    method: gray_world
  
  # 2. Resize MAIOR (OpenOCR funciona melhor com imagens grandes)
  resize:
    enabled: true
    min_height: 96   # ‚¨ÜÔ∏è DOBROU de 56 ‚Üí 96 (imagens maiores = mais detalhes)
    min_width: 384   # ‚¨ÜÔ∏è DOBROU de 224 ‚Üí 384
    max_height: 512  # ‚ú® NOVO: limita pra n√£o explodir mem√≥ria
    max_width: 2048  # ‚ú® NOVO: limita largura m√°xima
    maintain_aspect: true
    interpolation: lanczos  # Mant√©m - melhor qualidade
  
  # 3. Deskew
  deskew:
    enabled: true
    method: contours
    max_angle: 360
  
  # 4. CLAHE - DESABILITADO (estava piorando)
  clahe:
    enabled: false
    clip_limit: 1.5
    tile_grid_size: [4, 4]
    color_space: lab
  
  # 5. Sharpen MAIS FORTE (reduz blur + agu√ßa texto)
  sharpen:
    enabled: true
    method: unsharp_mask
    strength: 0.7  # ‚¨ÜÔ∏è AUMENTADO de 0.3 ‚Üí 0.7 (mais n√≠tido)
    radius: 1.0    # ‚¨ÜÔ∏è AUMENTADO de 0.5 ‚Üí 1.0 (alcance maior)
    threshold: 1   # ‚¨áÔ∏è REDUZIDO de 2 ‚Üí 1 (sharpeia mais √°reas)
  
  # 6. Denoising DESABILITADO (estava borrando)
  denoise:
    enabled: false  # ‚ùå DESATIVADO - bilateral borra detalhes
    method: bilateral
    d: 3
    sigma_color: 20
    sigma_space: 20
  
  # 7. Padding generoso (imagens maiores = mais margem)
  padding:
    enabled: true
    size: 20  # ‚¨ÜÔ∏è AUMENTADO de 12 ‚Üí 20 (proporcional ao tamanho)
    color: [255, 255, 255]
  
  # DESABILITADOS
  grayscale:
    enabled: false
  
  threshold:
    enabled: false
  
  morphology:
    enabled: false

# ============================================================================
# Mudan√ßas para MAIOR + MAIS N√çTIDO:
# ============================================================================
# 
# üîç IMAGEM MAIOR:
# ‚úÖ min_height: 56 ‚Üí 96 (+71% maior)
# ‚úÖ min_width: 224 ‚Üí 384 (+71% maior)
# ‚úÖ max_height: 512 (novo - evita imagens gigantes)
# ‚úÖ max_width: 2048 (novo - evita imagens gigantes)
# 
# üî™ MENOS BLUR:
# ‚ùå denoise: DESABILITADO (bilateral borra n√∫meros pequenos)
# ‚úÖ sharpen strength: 0.3 ‚Üí 0.7 (mais n√≠tido)
# ‚úÖ sharpen radius: 0.5 ‚Üí 1.0 (alcance maior)
# ‚úÖ sharpen threshold: 2 ‚Üí 1 (sharpeia mais √°reas)
# 
# üéØ OUTROS AJUSTES:
# ‚úÖ deskew max_angle: 360 ‚Üí 15¬∞ (menos distor√ß√£o)
# ‚úÖ padding: 12 ‚Üí 20 (proporcional ao tamanho maior)
# ‚ùå CLAHE: continua desabilitado (estava piorando)
# 
# ============================================================================
# L√ìGICA:
# ============================================================================
# 
# Por que MAIOR √© melhor:
# - OpenOCR √© CNN-based: mais pixels = mais features extra√≠das
# - Seus crops s√£o pequenos: upscale ajuda o modelo a "ver" melhor
# - Lanczos interpolation mant√©m qualidade no upscale
# 
# Por que DESABILITAR denoise:
# - Bilateral blur com d=3 ainda borra caracteres finos (1, /, :, .)
# - OpenOCR j√° tem robustez interna a ru√≠do
# - Melhor ter ru√≠do do que blur
# 
# Por que AUMENTAR sharpen:
# - Compensa qualquer blur residual do resize
# - Agu√ßa bordas de n√∫meros borrados em JPG comprimido
# - Radius 1.0 + threshold 1 = mais agressivo mas controlado
# 
# ============================================================================